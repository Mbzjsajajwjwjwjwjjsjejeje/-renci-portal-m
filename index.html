<!DOCTYPE html>
<html lang="tr">
<head>
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <meta charset="UTF-8">
Â  Â  <title>Ã–ÄŸrenci PortalÄ±m v18.0</title>
Â  Â Â 
Â  Â  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
Â  Â  <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
Â  Â  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
Â  Â  <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.2/chess.js"></script>

Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
Â  Â  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

Â  Â  <style>
Â  Â  Â  Â  /* --- MOBÄ°L UYUM KODLARI BAÅLANGICI --- */
@media screen and (max-width: 768px) {
Â  Â Â 
Â  Â  /* 1. Yan yana duran her ÅŸeyi alt alta indir */
Â  Â  body, .main-container, .container, .wrapper {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  flex-direction: column !important;
Â  Â  Â  Â  width: 100% !important;
Â  Â  Â  Â  padding: 0 !important;
Â  Â  Â  Â  margin: 0 !important;
Â  Â  }

Â  Â  /* 2. Sol MenÃ¼yÃ¼ (Sidebar) Ãœst MenÃ¼ yap veya kÃ¼Ã§Ã¼lt */
Â  Â  .sidebar, .menu, nav {
Â  Â  Â  Â  width: 100% !important;
Â  Â  Â  Â  height: auto !important;
Â  Â  Â  Â  position: relative !important;
Â  Â  Â  Â  display: block !important;
Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  }

Â  Â  /* 3. Ana Ä°Ã§erik AlanÄ±nÄ± GeniÅŸlet */
Â  Â  .content, .main-content {
Â  Â  Â  Â  margin-left: 0 !important;
Â  Â  Â  Â  width: 100% !important;
Â  Â  Â  Â  padding: 10px !important;
Â  Â  Â  Â  box-sizing: border-box; /* KutularÄ±n taÅŸmasÄ±nÄ± engeller */
Â  Â  }

Â  Â  /* 4. SATRANÃ‡ VE GÃ–REVLER (Iframe ve Tablolar) */
Â  Â  iframe, object, embed {
Â  Â  Â  Â  width: 100% !important; /* Tahta ekrana sÄ±ÄŸsÄ±n */
Â  Â  Â  Â  height: 400px !important; /* YÃ¼ksekliÄŸi ayarlayalÄ±m */
Â  Â  Â  Â  border: none;
Â  Â  }

Â  Â  /* 5. ÅÄ°KAYET KUTULARI (Formlar) */
Â  Â  input, textarea, select, button {
Â  Â  Â  Â  width: 100% !important; /* Kutular tam geniÅŸlik olsun */
Â  Â  Â  Â  font-size: 16px !important; /* Telefondan rahat okunur */
Â  Â  Â  Â  padding: 10px !important;
Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  }

Â  Â  /* 6. YazÄ± boyutlarÄ±nÄ± telefona gÃ¶re ayarla */
Â  Â  h1 { font-size: 24px !important; }
Â  Â  h2 { font-size: 20px !important; }
Â  Â  p, li { font-size: 16px !important; }
}
/* --- MOBÄ°L UYUM KODLARI BÄ°TÄ°ÅÄ° --- */
Â  Â  Â  Â  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

Â  Â  Â  Â  :root { --primary: #6c5ce7; --secondary: #a29bfe; --bg: #dfe6e9; --panel: #fff; --text: #2d3436; --danger: #d63031; --success: #00b894; --sidebar-bg: rgba(0,0,0,0.03); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body.koyu-mod {Â 
Â  Â  Â  Â  Â  Â  --primary: #a29bfe; --secondary: #6c5ce7;Â 
Â  Â  Â  Â  Â  Â  --panel: #2d3436; --text: #dfe6e9;Â 
Â  Â  Â  Â  Â  Â  --sidebar-bg: rgba(255,255,255,0.05);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body {Â 
Â  Â  Â  Â  Â  Â  font-family: 'Poppins', sans-serif;Â 
Â  Â  Â  Â  Â  Â  background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
Â  Â  Â  Â  Â  Â  background-size: 400% 400%;
Â  Â  Â  Â  Â  Â  animation: gradientBG 15s ease infinite;
Â  Â  Â  Â  Â  Â  margin: 0; height: 100vh; display: flex; justify-content: center; align-items: center; color: var(--text);Â 
Â  Â  Â  Â  Â  Â  transition: background 0.5s;
Â  Â  Â  Â  }

Â  Â  Â  Â  body.koyu-mod {
Â  Â  Â  Â  Â  Â  background: linear-gradient(-45deg, #2c3e50, #000000, #434343);
Â  Â  Â  Â  Â  Â  background-size: 400% 400%;
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

Â  Â  Â  Â  .container { background: var(--panel); border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; transition: 0.3s; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .auth-box {Â 
Â  Â  Â  Â  Â  Â  padding: 50px 40px; width: 380px; text-align: center;
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.25);
Â  Â  Â  Â  Â  Â  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
Â  Â  Â  Â  Â  Â  border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.18); color: white;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .auth-box input { background: rgba(255, 255, 255, 0.9); border: none; padding: 15px; margin-bottom: 15px; border-radius: 30px; width: 100%; box-sizing: border-box; outline: none; transition: 0.3s; }
Â  Â  Â  Â  .auth-box input:focus { transform: scale(1.05); }
Â  Â  Â  Â  .auth-box button { background: linear-gradient(to right, #6c5ce7, #a29bfe); border: none; padding: 15px; border-radius: 30px; width: 100%; color: white; cursor: pointer; font-weight: bold; transition: 0.3s; }
Â  Â  Â  Â  .auth-box button:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

Â  Â  Â  Â  .app-box { width: 1200px; height: 800px; display: flex; background: var(--panel); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @media screen and (max-width: 768px) {
Â  Â  Â  Â  Â  Â  .app-box { flex-direction: column; width: 100%; height: 100%; }
Â  Â  Â  Â  Â  Â  .sidebar { width: 100%; height: auto; flex-direction: row; overflow-x: auto; padding: 10px; }
Â  Â  Â  Â  Â  Â  .content { padding: 15px; }
Â  Â  Â  Â  Â  Â  #myBoard { width: 300px !important; }
Â  Â  Â  Â  Â  Â  .auth-box { width: 90%; }
Â  Â  Â  Â  }

Â  Â  Â  Â  .sidebar { width: 240px; background: var(--sidebar-bg); padding: 20px; display: flex; flex-direction: column; gap: 8px; border-right: 1px solid rgba(0,0,0,0.05); }
Â  Â  Â  Â  .content { flex: 1; padding: 30px; overflow-y: auto; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .menu-item { padding: 12px; cursor: pointer; border-radius: 10px; display: flex; align-items: center; gap: 10px; transition: 0.2s; font-size: 14px; }
Â  Â  Â  Â  .menu-item:hover, .menu-item.active { background: var(--primary); color: white; transform: translateX(5px); box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .page { display: none; } .page.active { display: block; animation: fadeIn 0.5s; }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

Â  Â  Â  Â  input, button, textarea, select { width: 100%; padding: 10px; margin: 5px 0; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box; font-family: 'Poppins', sans-serif;}
Â  Â  Â  Â  body.koyu-mod input, body.koyu-mod textarea, body.koyu-mod select { background: rgba(255,255,255,0.1); color: white; border: 1px solid #444; }
Â  Â  Â  Â  .gizli { display: none !important; }

Â  Â  Â  Â  .item-card { background: rgba(0,0,0,0.03); padding: 15px; margin-bottom: 10px; border-radius: 10px; border-left: 5px solid var(--secondary); display: flex; justify-content: space-between; align-items: center; transition: 0.3s; }
Â  Â  Â  Â  body.koyu-mod .item-card { background: rgba(255,255,255,0.05); }
Â  Â  Â  Â  .basarili { border-left-color: var(--success); background: rgba(0, 184, 148, 0.1); opacity: 0.9; }
Â  Â  Â  Â  .basarisiz { border-left-color: var(--danger); background: rgba(214, 48, 49, 0.1); opacity: 0.9; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #myBoard { margin: 0 auto; width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border-radius: 5px; }
Â  Â  Â  Â  .timers { display: flex; justify-content: space-between; width: 400px; margin: 0 auto 15px auto; font-size: 18px; font-weight: 600; }
Â  Â  Â  Â  .timer-box { padding: 8px 20px; border-radius: 8px; background: #f1f2f6; min-width: 90px; text-align: center; transition: 0.3s; border: 2px solid transparent; color: #333;}
Â  Â  Â  Â  .timer-active { background: white; border-color: var(--primary); color: var(--primary); box-shadow: 0 0 15px rgba(108, 92, 231, 0.2); transform: scale(1.05); }

Â  Â  Â  Â  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
Â  Â  Â  Â  th, td { border: 1px solid #eee; padding: 10px; text-align: center; font-size: 13px; }
Â  Â  Â  Â  body.koyu-mod th, body.koyu-mod td { border-color: #444; }
Â  Â  Â  Â  th { background: rgba(0,0,0,0.05); }
Â  Â  Â  Â  body.koyu-mod th { background: rgba(255,255,255,0.05); }
Â  Â  Â  Â  .ders-input { border: none; background: transparent; text-align: center; width: 100%; outline: none; color: inherit; }

Â  Â  Â  Â  #beklemeEkrani {
Â  Â  Â  Â  Â  Â  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(255,255,255,0.9); z-index: 99;
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; justify-content: center; align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  body.koyu-mod #beklemeEkrani { background: rgba(30,30,30,0.95); }
Â  Â  Â  Â  .spinner { border: 5px solid #f3f3f3; border-top: 5px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin-bottom: 20px; }
Â  Â  Â  Â  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
Â  Â  Â  Â  #geriSayimText { font-size: 80px; font-weight: bold; color: var(--primary); animation: pop 0.5s ease; }
Â  Â  Â  Â  @keyframes pop { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

Â  Â  Â  Â  .dashboard-card { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; padding: 20px; border-radius: 15px; flex: 1; text-align: center; box-shadow: 0 10px 20px rgba(0,0,0,0.1); margin: 10px; }
Â  Â  Â  Â  .dashboard-card h3 { font-size: 36px; margin: 10px 0; }
Â  Â  Â  Â  .dashboard-container { display: flex; flex-wrap: wrap; justify-content: space-between; }

Â  Â  Â  Â  .pomodoro-circle { width: 200px; height: 200px; border-radius: 50%; border: 5px solid var(--primary); display: flex; justify-content: center; align-items: center; font-size: 40px; font-weight: bold; margin: 20px auto; color: var(--primary); }
Â  Â  </style>
</head>
<body>

Â  Â  <div id="authScreen" class="auth-box">
Â  Â  Â  Â  <h2 style="font-size: 28px; margin-bottom: 20px;"><i class="fas fa-graduation-cap"></i> Ã–ÄŸrenci PortalÄ±</h2>
Â  Â  Â  Â  <input type="text" id="kAdi" placeholder="KullanÄ±cÄ± AdÄ±">
Â  Â  Â  Â  <input type="password" id="sifre" placeholder="Åifre">
Â  Â  Â  Â  <button onclick="islemYap()">GiriÅŸ Yap</button>
Â  Â  Â  Â  <p onclick="modDegistir()" style="cursor:pointer; font-size:13px; margin-top:15px; text-decoration: underline;">HesabÄ±n yok mu? KayÄ±t Ol</p>
Â  Â  </div>

Â  Â  <div id="appScreen" class="container app-box gizli">
Â  Â  Â  Â  <div class="sidebar">
Â  Â  Â  Â  Â  Â  <h3 style="text-align:center; color: var(--primary); margin-top: 0;"><i class="fas fa-cube"></i> MenÃ¼</h3>
Â  Â  Â  Â  Â  Â  <div class="menu-item active" onclick="sayfaGec('dashboard')"><i class="fas fa-home"></i> Ana Sayfa</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('pomodoro')"><i class="fas fa-clock"></i> Ders Ã‡alÄ±ÅŸma</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('oyunlar')"><i class="fas fa-chess-king"></i> Arena (Online)</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('todo')"><i class="fas fa-stopwatch"></i> ZamanlÄ± GÃ¶revler</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('notlar')"><i class="fas fa-calculator"></i> Not Hesapla</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('program')"><i class="fas fa-calendar-alt"></i> Ders ProgramÄ±</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('gunluk')"><i class="fas fa-book"></i> GÃ¼nlÃ¼ÄŸÃ¼m</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('sohbet')"><i class="fas fa-comments"></i> Sohbet (CanlÄ±)</div>
Â  Â  Â  Â  Â  Â  <div class="menu-item" onclick="sayfaGec('iletisim')"><i class="fas fa-envelope"></i> Åikayet/Ã–neri</div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div style="margin-top:auto; text-align:center;">
Â  Â  Â  Â  Â  Â  Â  Â  <p id="karsilama" style="font-size:14px; font-weight:bold;"></p>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="background: rgba(255,255,255,0.1); padding: 5px; margin-bottom: 5px; border-radius: 5px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="yedekIndir()" style="width:100%; font-size:11px; background:#00b894; border:none; padding:5px; color:white; border-radius:3px; cursor:pointer;">ğŸ’¾ Yedek Ä°ndir</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" id="yedekYukleInput" style="display:none" onchange="yedekYukle(this)">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="document.getElementById('yedekYukleInput').click()" style="width:100%; font-size:11px; background:#0984e3; border:none; padding:5px; color:white; border-radius:3px; cursor:pointer; margin-top:5px;">ğŸ“‚ Yedek YÃ¼kle</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="koyuModToggle()" style="background:#2d3436; color:white; padding:8px; font-size:12px; margin-top:10px; border:none; width:100%; border-radius:5px;">ğŸŒ— Mod DeÄŸiÅŸtir</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="location.reload()" style="background:#ff7675; color:white; padding:8px; font-size:12px; margin-top:5px; border:none; width:100%; border-radius:5px;">Ã‡Ä±kÄ±ÅŸ</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="content">
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="dashboard" class="page active">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ‘‹ HoÅŸgeldin, <span id="dashUser"></span></h2>
Â  Â  Â  Â  Â  Â  Â  Â  <p>Ä°ÅŸte bugÃ¼nkÃ¼ durum Ã¶zetin:</p>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="dashboard-container">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="dashboard-card" style="background: linear-gradient(135deg, #6c5ce7, #a29bfe);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-chess-king" style="font-size:24px;"></i><h3 id="dashPuan">0</h3><span>SatranÃ§ PuanÄ±</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="dashboard-card" style="background: linear-gradient(135deg, #00b894, #55efc4);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-check-circle" style="font-size:24px;"></i><h3 id="dashGorev">0</h3><span>Bekleyen GÃ¶rev</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="dashboard-card" style="background: linear-gradient(135deg, #e17055, #fab1a0);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-book" style="font-size:24px;"></i><h3 id="dashGunluk">0</h3><span>GÃ¼nlÃ¼k SayfasÄ±</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="pomodoro" class="page" style="text-align:center;">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ… Derse Odaklanma</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <p>25 Dakika Ders, 5 Dakika Mola</p>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="pomodoro-circle" id="pomoSure">25:00</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="dersBaslat()" style="width:auto; background:var(--primary); color:white; border:none; padding:10px 20px;">Ders BaÅŸlat (25dk)</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="molaBaslat()" style="width:auto; background:var(--success); color:white; border:none; padding:10px 20px;">Mola Ver (5dk)</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="btnPomoDur" onclick="durdurToggle()" style="width:auto; background:var(--danger); color:white; border:none; padding:10px 20px;">Durdur</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="oyunlar" class="page" style="position: relative;">
Â  Â  Â  Â  Â  Â  Â  Â  <div id="beklemeEkrani" class="gizli">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="beklemeIcerik" style="text-align: center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="spinner"></div><h2 id="beklemeYazisi">RAKÄ°P BEKLENÄ°YOR...</h2><p>BaÅŸka bir kullanÄ±cÄ± baÄŸlanana kadar bekleyin.</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="beklemeyiIptalEt()" style="background:#d63031; color:white; border:none; width:auto; padding:10px 20px;">Ä°ptal</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="geriSayimIcerik" class="gizli" style="text-align: center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2>RAKÄ°P BULUNDU!</h2><p>Oyun baÅŸlÄ±yor...</p><div id="geriSayimText">5</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <h2 style="text-align:center; color: var(--primary);">â™Ÿï¸ SatranÃ§</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; justify-content:center; gap:15px; margin-bottom:25px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="oyunModuSec('bot')" style="width:auto; background:#b2bec3; border:none; color:white;">ğŸ¤– Antrenman (Bot)</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="dereceliGir()" style="width:auto; background: linear-gradient(to right, #ff9f43, #ee5253); border:none; color:white; box-shadow: 0 4px 15px rgba(238, 82, 83, 0.4);">ğŸ”¥ Dereceli (+250 Puan)</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="oyunAlani" class="gizli">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="timers"><div id="timerW" class="timer-box">Beyaz: 10:00</div><div id="timerB" class="timer-box">Siyah: 10:00</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="text-align:center; font-weight:bold; margin-bottom:10px;" id="oyunDurum">Hamle SÄ±rasÄ±: Beyaz</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="myBoard"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="text-align:center; margin-top:20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="pesEt()" style="width:auto; background:#d63031; color:white; border:none;">Oyunu Bitir / Pes Et</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="lobiAlani" style="text-align:center; padding:20px;"><h3>Lobiye HoÅŸgeldin</h3><p>Rakibini beklemek istemiyorsan hemen bir mod seÃ§.</p></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="todo" class="page">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>â±ï¸ ZamanlÄ± GÃ¶rev Listesi</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input id="todoIn" placeholder="GÃ¶rev nedir?"><input type="number" id="todoTime" placeholder="Sn" style="width:80px;" min="1" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="gorevEkle()" style="width:80px; background:var(--success); color:white; border:none;">BaÅŸlat</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="todoList" style="margin-top:20px;"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="notlar" class="page">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ§® Vize / Final Hesapla</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:10px; align-items:center;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input id="dersAdi" placeholder="Ders AdÄ±"><input id="vizeNot" type="number" placeholder="Vize (%40)" style="width:100px;"><input id="finalNot" type="number" placeholder="Final (%60)" style="width:100px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="notHesapla()" style="width:100px; background:var(--primary); color:white; border:none;">Hesapla</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="notListesi" style="margin-top:20px;"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="program" class="page">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ“… HaftalÄ±k Ders ProgramÄ±</h2><p style="font-size:12px; opacity:0.7;">Dersleri kutulara yaz ve Kaydet'e bas. Hepsi hafÄ±zada kalÄ±r.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="programTablosu"><thead><tr><th>Saat</th><th>Pzt</th><th>Sal</th><th>Ã‡ar</th><th>Per</th><th>Cum</th></tr></thead><tbody></tbody></table>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="programKaydet()" style="margin-top:10px; width:auto; background:var(--success); color:white; border:none;">ğŸ’¾ ProgramÄ± Kaydet</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="gunluk" class="page">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ“” GÃ¼nlÃ¼k</h2><textarea id="gunlukIn" rows="5" maxlength="2000" placeholder="BugÃ¼n neler yaÅŸadÄ±n? (Max 2000 karakter)"></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="gunlukEkle()" style="background:var(--secondary); color:white; border:none;">GÃ¼nlÃ¼ÄŸe Yaz</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="gunlukList" style="margin-top:20px;"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="sohbet" class="page">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ’¬ Sohbet OdasÄ± (GÃ¼nlÃ¼k SÄ±fÄ±rlanÄ±r)</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="chatArea" style="height:400px; overflow-y:scroll; border:1px solid #eee; padding:15px; border-radius:10px; margin-bottom:10px;"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex; gap:10px;"><input id="chatIn" placeholder="MesajÄ±nÄ± yaz..."><button onclick="chatYolla()" style="width:80px; background:var(--primary); color:white; border:none;">Yolla</button></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="iletisim" class="page">
Â  Â  Â  Â  Â  Â  Â  Â  <h2>ğŸ“¬ Åikayet ve Ã–neri</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="oneriTur"><option value="Ã–neri">Ã–neri</option><option value="Åikayet">Åikayet</option></select>
Â  Â  Â  Â  Â  Â  Â  Â  <input id="oneriKonu" placeholder="Konu"><textarea id="oneriMesaj" rows="4" placeholder="MesajÄ±nÄ±z..."></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="oneriYolla()" style="background:#e17055; color:white; border:none;">ğŸ“§ Kaydet ve E-Posta GÃ¶nder</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="oneriList" style="margin-top:20px;"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // --- BURAYI KENDÄ° BÄ°LGÄ°LERÄ°NLE DOLDUR ---
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDxsw-OTjvlrPvscjO4LsGzKEceKOW-Iuc",
  authDomain: "ogrenci-portali-f4cad.firebaseapp.com",
  projectId: "ogrenci-portali-f4cad",
  storageBucket: "ogrenci-portali-f4cad.firebasestorage.app",
  messagingSenderId: "901945087688",
  appId: "1:901945087688:web:24f1a877f49a15edc577fd",
  measurementId: "G-JEL3H6H45T"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
        // ----------------------------------------

Â  Â  Â  Â  firebase.initializeApp(firebaseConfig);
Â  Â  Â  Â  const database = firebase.database();

Â  Â  Â  Â  let user = null, kayit = false;
Â  Â  Â  Â  let board = null, game = new Chess();
Â  Â  Â  Â  let aktifMod = null;
Â  Â  Â  Â  let wTime = 600, bTime = 600, timerInterval = null;
Â  Â  Â  Â  let myColor = 'w';Â 
Â  Â  Â  Â  let pomoInterval = null, pomoKalan = 0, pomoDurum = false, pomoMod = "";Â 

Â  Â  Â  Â  if(localStorage.getItem("koyuMod") === "1") document.body.classList.add("koyu-mod");

Â  Â  Â  Â  function modDegistir() { kayit=!kayit; document.querySelector("#authScreen h2").innerText=kayit?"KayÄ±t Ol":"Ã–ÄŸrenci PortalÄ±"; }
Â  Â  Â  Â  function islemYap() {
Â  Â  Â  Â  Â  Â  let k=document.getElementById("kAdi").value, s=document.getElementById("sifre").value;
Â  Â  Â  Â  Â  Â  if(!k||!s) return alert("BoÅŸ bÄ±rakma!");
Â  Â  Â  Â  Â  Â  if(kayit) {
Â  Â  Â  Â  Â  Â  Â  Â  if(localStorage.getItem("u_"+k)) return alert("Bu kullanÄ±cÄ± adÄ± alÄ±nmÄ±ÅŸ!");
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem("u_"+k, s); localStorage.setItem("puan_"+k, 0); alert("KayÄ±t BaÅŸarÄ±lÄ±!"); modDegistir();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  if(localStorage.getItem("u_"+k)==s) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  user=k; document.getElementById("authScreen").classList.add("gizli");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("appScreen").classList.remove("gizli");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("karsilama").innerText="ğŸ‘¤ "+user;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  yukle();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  baslatSohbetDinleyici();
Â  Â  Â  Â  Â  Â  Â  Â  } else alert("HatalÄ± kullanÄ±cÄ± adÄ± veya ÅŸifre!");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  function sayfaGec(id) { document.querySelectorAll(".page").forEach(p=>p.classList.remove("active")); document.querySelectorAll(".menu-item").forEach(m=>m.classList.remove("active")); document.getElementById(id).classList.add("active"); event.currentTarget.classList.add("active"); yukle(); }
Â  Â  Â  Â  function koyuModToggle() { document.body.classList.toggle("koyu-mod"); localStorage.setItem("koyuMod", document.body.classList.contains("koyu-mod") ? "1" : "0"); }
Â  Â  Â  Â  function getVeri(key) { return JSON.parse(localStorage.getItem(key+"_"+user)||"[]"); }
Â  Â  Â  Â  function setVeri(key, val) { localStorage.setItem(key+"_"+user, JSON.stringify(val)); }

Â  Â  Â  Â  function yukle() {
Â  Â  Â  Â  Â  Â  let puan = localStorage.getItem("puan_"+user)||"0";
Â  Â  Â  Â  Â  Â  let gorevler = getVeri("todo");
Â  Â  Â  Â  Â  Â  let gunlukler = getVeri("gunluk");
Â  Â  Â  Â  Â  Â  document.getElementById("dashUser").innerText = user; document.getElementById("dashPuan").innerText = puan;
Â  Â  Â  Â  Â  Â  document.getElementById("dashGorev").innerText = gorevler.filter(g => g.durum === 'bekliyor').length;
Â  Â  Â  Â  Â  Â  document.getElementById("dashGunluk").innerText = gunlukler.length;

Â  Â  Â  Â  Â  Â  let nl = document.getElementById("notListesi"); nl.innerHTML="";
Â  Â  Â  Â  Â  Â  getVeri("notlar").forEach((x,i) => { nl.innerHTML+=`<div class="item-card ${x.sonuc>=50?'basarili':'basarisiz'}"><b>${x.ders}</b>: Ort: ${x.sonuc} <button onclick="sil('notlar',${i})" style="background:white;color:black;border:none;">Sil</button></div>`; });

Â  Â  Â  Â  Â  Â  let gl = document.getElementById("gunlukList"); gl.innerHTML="";
Â  Â  Â  Â  Â  Â  gunlukler.forEach((x, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  gl.innerHTML += `<div class="item-card" style="display:block"><div style="display:flex;justify-content:space-between;"><b>GÃ¼n ${gunlukler.length-i}</b><div><button onclick="gunlukAc(${i})" style="margin-right:5px;background:var(--primary);color:white;border:none;">Oku</button><button onclick="gunlukSil(${i})" style="background:#d63031;color:white;border:none;">Sil</button></div></div><div id="g_detay_${i}" class="gizli" style="margin-top:10px;border-top:1px solid #ccc;">${x.txt}</div></div>`;
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  let ol = document.getElementById("oneriList"); ol.innerHTML="";
Â  Â  Â  Â  Â  Â  getVeri("oneri").forEach(x => ol.innerHTML+=`<div class="item-card" style="display:block"><b>${x.tur}</b>: ${x.konu}<br><small>${x.msg}</small></div>`);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let tl = document.getElementById("todoList"); tl.innerHTML="";
Â  Â  Â  Â  Â  Â  gorevler.forEach((g, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  let btn = g.durum === 'bekliyor' ? `<button onclick="gorevSil(${index})" style="background:#d63031;color:white;border:none;">Sil</button>` : `<button onclick="gorevSil(${index})" style="background:white;color:black;border:none;">Sil</button>`;
Â  Â  Â  Â  Â  Â  Â  Â  tl.innerHTML += `<div class="item-card ${g.durum==='basarili'?'basarili':(g.durum==='basarisiz'?'basarisiz':'')}"><span>${g.txt} (${g.s} sn)</span> <span>${g.durum==='basarili'?'âœ…':(g.durum==='basarisiz'?'âŒ':'â³')}</span> ${btn}</div>`;
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  programTabloOlustur();
Â  Â  Â  Â  }

Â  Â  Â  Â  function sil(k, i) { let d=getVeri(k); d.splice(i,1); setVeri(k,d); yukle(); }
Â  Â  Â  Â  function gorevSil(i) { sil("todo",i); }
Â  Â  Â  Â  function gorevEkle() {
Â  Â  Â  Â  Â  Â  let t = document.getElementById("todoIn").value, s = parseInt(document.getElementById("todoTime").value);
Â  Â  Â  Â  Â  Â  if(!t || !s) return;
Â  Â  Â  Â  Â  Â  let d = getVeri("todo"); d.unshift({ txt: t, s: s, durum: 'bekliyor' }); setVeri("todo", d);
Â  Â  Â  Â  Â  Â  document.getElementById("todoIn").value=""; document.getElementById("todoTime").value=""; yukle(); baslatGorevTimer(0, s);Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  function baslatGorevTimer(idx, sure) {
Â  Â  Â  Â  Â  Â  let tl = document.getElementById("todoList"), div = tl.children[0];Â 
Â  Â  Â  Â  Â  Â  div.innerHTML = `<span>${getVeri("todo")[0].txt}</span> <span id="sayacSpan">â³ ${sure}</span> <button id="bitirBtn" style="background:#00b894;color:white;border:none;">Bitir</button>`;
Â  Â  Â  Â  Â  Â  let sayac = setInterval(() => { sure--; div.querySelector("#sayacSpan").innerText = `â³ ${sure}`; if(sure <= 0) { clearInterval(sayac); guncelleGorevDurumu(0,'basarisiz'); } }, 1000);
Â  Â  Â  Â  Â  Â  div.querySelector("#bitirBtn").onclick = () => { clearInterval(sayac); guncelleGorevDurumu(0,'basarili'); }
Â  Â  Â  Â  }
Â  Â  Â  Â  function guncelleGorevDurumu(i, d) { let data=getVeri("todo"); if(data[i]){ data[i].durum=d; setVeri("todo",data); yukle(); } }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function notHesapla() {
Â  Â  Â  Â  Â  Â  let d=document.getElementById("dersAdi").value, v=Number(document.getElementById("vizeNot").value), f=Number(document.getElementById("finalNot").value);
Â  Â  Â  Â  Â  Â  if(d) { let veri=getVeri("notlar"); veri.push({ders:d, sonuc:((v*0.4)+(f*0.6)).toFixed(1)}); setVeri("notlar", veri); yukle(); }
Â  Â  Â  Â  }
Â  Â  Â  Â  function gunlukEkle() { let t=document.getElementById("gunlukIn").value; if(t) { let d=getVeri("gunluk"); d.unshift({t:new Date().toLocaleDateString(), txt:t}); setVeri("gunluk",d); document.getElementById("gunlukIn").value=""; yukle(); } }
Â  Â  Â  Â  function gunlukAc(i) { document.getElementById("g_detay_"+i).classList.toggle("gizli"); }
Â  Â  Â  Â  function gunlukSil(i) { sil("gunluk",i); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function oneriYolla() {Â 
Â  Â  Â  Â  Â  Â  let t=document.getElementById("oneriTur").value, k=document.getElementById("oneriKonu").value, m=document.getElementById("oneriMesaj").value;
Â  Â  Â  Â  Â  Â  if(!k||!m) return alert("Doldur!");
Â  Â  Â  Â  Â  Â  let d=getVeri("oneri"); d.unshift({tur:t, konu:k, msg:m}); setVeri("oneri",d);
Â  Â  Â  Â  Â  Â  window.location.href = `mailto:mustafasoylemez2000@gmail.com?subject=[${t}] ${k} - ${user}&body=GÃ¶nderen: ${user}%0D%0A%0D%0A${m}`;
Â  Â  Â  Â  Â  Â  document.getElementById("oneriKonu").value=""; document.getElementById("oneriMesaj").value=""; yukle();Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  function programTabloOlustur() {
Â  Â  Â  Â  Â  Â  let t = document.querySelector("#programTablosu tbody"); t.innerHTML = "";
Â  Â  Â  Â  Â  Â  let s = ["09:00", "10:00", "11:00", "13:00", "14:00"], k = JSON.parse(localStorage.getItem("program_"+user) || "{}");
Â  Â  Â  Â  Â  Â  s.forEach((saat, idx) => {
Â  Â  Â  Â  Â  Â  Â  Â  let tr = document.createElement("tr"); tr.innerHTML = `<td><b>${saat}</b></td>`;
Â  Â  Â  Â  Â  Â  Â  Â  for(let i=0; i<5; i++) tr.innerHTML += `<td><input type="text" class="ders-input" id="d_${idx}_${i}" value="${k['d_'+idx+'_'+i]||''}" placeholder="..."></td>`;
Â  Â  Â  Â  Â  Â  Â  Â  t.appendChild(tr);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  function programKaydet() {
Â  Â  Â  Â  Â  Â  let v = {}; document.querySelectorAll(".ders-input").forEach(i => { if(i.value) v[i.id]=i.value; });
Â  Â  Â  Â  Â  Â  localStorage.setItem("program_"+user, JSON.stringify(v)); alert("Kaydedildi!");
Â  Â  Â  Â  }

Â  Â  Â  Â  function dersBaslat() { if(pomoMod==='mola' && pomoKalan>0 && !confirm("Mola bitmedi?")) return; if(pomoMod==='ders'&&pomoKalan>0&&!pomoDurum) {sayacBaslat();return;} pomoMod='ders';pomoKalan=25*60;sayacBaslat(); }
Â  Â  Â  Â  function molaBaslat() { if(pomoMod==='ders' && pomoKalan>0) return alert("Ders bitmedi!"); if(pomoMod==='mola'&&pomoKalan>0&&!pomoDurum) {sayacBaslat();return;} pomoMod='mola';pomoKalan=5*60;sayacBaslat(); }
Â  Â  Â  Â  function sayacBaslat() { clearInterval(pomoInterval); pomoDurum=true; document.getElementById("btnPomoDur").innerText="Durdur"; pomoInterval=setInterval(()=>{ pomoKalan--; let m=Math.floor(pomoKalan/60),s=pomoKalan%60; document.getElementById("pomoSure").innerText=`${m}:${s<10?'0':''}${s}`; if(pomoKalan<=0){clearInterval(pomoInterval);pomoDurum=false;alert("SÃ¼re bitti!");} },1000); }
Â  Â  Â  Â  function durdurToggle() { if(pomoKalan<=0) return; if(pomoDurum){clearInterval(pomoInterval);pomoDurum=false;document.getElementById("btnPomoDur").innerText="Devam Et";}else{sayacBaslat();} }

Â  Â  Â  Â  // --- CHESS & ONLINE ---
Â  Â  Â  Â  function dereceliGir() {
Â  Â  Â  Â  Â  Â  document.getElementById("lobiAlani").classList.add("gizli"); document.getElementById("beklemeEkrani").classList.remove("gizli");
Â  Â  Â  Â  Â  Â  database.ref('lobby').once('value', snapshot => {
Â  Â  Â  Â  Â  Â  Â  Â  let lobby = snapshot.val();
Â  Â  Â  Â  Â  Â  Â  Â  if (!lobby || lobby.status === 'empty') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  database.ref('lobby').set({ status: 'waiting', p1: user });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  myColor = 'w';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  database.ref('lobby').on('child_changed', s => { if(s.val()==='ready') baslatGeriSayim(); });
Â  Â  Â  Â  Â  Â  Â  Â  } else if (lobby.status === 'waiting') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  database.ref('lobby').update({ status: 'ready', p2: user });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  myColor = 'b';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  baslatGeriSayim();
Â  Â  Â  Â  Â  Â  Â  Â  } else { alert("Dolu!"); beklemeyiIptalEt(); }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  function beklemeyiIptalEt() {Â 
Â  Â  Â  Â  Â  Â  database.ref('lobby').get().then(s => { if(s.val()?.p1===user) database.ref('lobby').set({status:'empty'}); });
Â  Â  Â  Â  Â  Â  document.getElementById("beklemeEkrani").classList.add("gizli"); document.getElementById("lobiAlani").classList.remove("gizli");
Â  Â  Â  Â  }
Â  Â  Â  Â  function baslatGeriSayim() {
Â  Â  Â  Â  Â  Â  document.getElementById("beklemeIcerik").classList.add("gizli"); document.getElementById("geriSayimIcerik").classList.remove("gizli");
Â  Â  Â  Â  Â  Â  let c=5, i=setInterval(()=>{ c--; document.getElementById("geriSayimText").innerText=c; if(c<=0){ clearInterval(i); document.getElementById("beklemeEkrani").classList.add("gizli"); oyunModuSec('online_start'); } },1000);
Â  Â  Â  Â  }
Â  Â  Â  Â  function oyunModuSec(mod) {
Â  Â  Â  Â  Â  Â  aktifMod = mod==='online_start'?'online':mod; document.getElementById("lobiAlani").classList.add("gizli"); document.getElementById("oyunAlani").classList.remove("gizli");
Â  Â  Â  Â  Â  Â  game.reset();Â 
Â  Â  Â  Â  Â  Â  if(aktifMod==='online') {Â 
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("oyunDurum").innerText="DERECELÄ° (Sen: "+(myColor=='w'?'Beyaz':'Siyah')+")";Â 
Â  Â  Â  Â  Â  Â  Â  Â  startClock();
Â  Â  Â  Â  Â  Â  Â  Â  database.ref('game').on('value', s => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let v = s.val(); if(v && v.fen !== game.fen()) { game.load(v.fen); board.position(v.fen); tahtaGuncelle(false); }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } else document.getElementById("oyunDurum").innerText="ANTRENMAN";
Â  Â  Â  Â  Â  Â  if(board) board.destroy();
Â  Â  Â  Â  Â  Â  board = Chessboard('myBoard', { draggable: true, position: 'start', onDragStart: onDragStart, onDrop: onDrop, onSnapEnd: () => board.position(game.fen()), orientation: aktifMod==='online'&&myColor==='b'?'black':'white' });
Â  Â  Â  Â  }
Â  Â  Â  Â  function onDragStart(s, p) { if(game.game_over() || (aktifMod==='bot' && game.turn()==='b') || (aktifMod==='online' && game.turn()!==myColor)) return false; }
Â  Â  Â  Â  function onDrop(s, t) {
Â  Â  Â  Â  Â  Â  let m = game.move({ from: s, to: t, promotion: 'q' }); if(m===null) return 'snapback';
Â  Â  Â  Â  Â  Â  tahtaGuncelle(true);
Â  Â  Â  Â  Â  Â  if(aktifMod==='bot') setTimeout(()=>{ game.move(game.moves()[Math.floor(Math.random()*game.moves().length)]); board.position(game.fen()); tahtaGuncelle(true); },250);
Â  Â  Â  Â  Â  Â  else if(aktifMod==='online') database.ref('game').set({ fen: game.fen(), turn: game.turn() });
Â  Â  Â  Â  }
Â  Â  Â  Â  function tahtaGuncelle(gonderenBenim) {
Â  Â  Â  Â  Â  Â  updateTimerUI();
Â  Â  Â  Â  Â  Â  if(game.game_over()) {
Â  Â  Â  Â  Â  Â  Â  Â  if(game.in_checkmate()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let k = game.turn()==='w'?'Siyah':'Beyaz';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert("KAZANAN: " + k);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(aktifMod==='online') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(k===(myColor=='w'?'Beyaz':'Siyah')) puanIsle(250); else puanIsle(-100);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  database.ref('lobby').set({status:'empty'});
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  function puanIsle(m) { let p=parseInt(localStorage.getItem("puan_"+user)||"0")+m; localStorage.setItem("puan_"+user,p); document.getElementById("kullaniciPuani").innerText=p; oyundanCik(); }
Â  Â  Â  Â  function pesEt() { if(aktifMod==='online') puanIsle(-200); else oyundanCik(); }
Â  Â  Â  Â  function oyundanCik() { clearInterval(timerInterval); document.getElementById("oyunAlani").classList.add("gizli"); document.getElementById("lobiAlani").classList.remove("gizli"); game.reset(); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function updateTimerUI() { /* Basitlik iÃ§in timer gÃ¶rseli sabit kalsÄ±n */ }
Â  Â  Â  Â  function startClock() { /* Online senkronizasyon karmaÅŸÄ±k, ÅŸimdilik gÃ¶rsel */ }

Â  Â  Â  Â  // --- ONLINE SOHBET ---
Â  Â  Â  Â  function baslatSohbetDinleyici() {
Â  Â  Â  Â  Â  Â  // Sadece bugÃ¼nÃ¼n mesajlarÄ±nÄ± gÃ¶ster
Â  Â  Â  Â  Â  Â  let bugun = new Date().toLocaleDateString();
Â  Â  Â  Â  Â  Â  database.ref('chat').on('child_added', s => {
Â  Â  Â  Â  Â  Â  Â  Â  let m = s.val();
Â  Â  Â  Â  Â  Â  Â  Â  // EÄŸer mesajÄ±n tarihi bugÃ¼ne eÅŸitse ekrana bas, deÄŸilse basma
Â  Â  Â  Â  Â  Â  Â  Â  if(m.tarih === bugun) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let div = `<div style="margin:5px;padding:5px;border-radius:5px;background:${m.u===user?'var(--primary)':'#eee'};color:${m.u===user?'white':'black'};width:fit-content;margin-left:${m.u===user?'auto':'0'}"><b>${m.u}:</b> ${m.t}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("chatArea").innerHTML += div;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById("chatArea").scrollTop = document.getElementById("chatArea").scrollHeight;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  function chatYolla() {
Â  Â  Â  Â  Â  Â  let t = document.getElementById("chatIn").value; if(!t) return;
Â  Â  Â  Â  Â  Â  // MesajÄ± atarken bugÃ¼nÃ¼n tarihini de ekle
Â  Â  Â  Â  Â  Â  database.ref('chat').push({ u: user, t: t, tarih: new Date().toLocaleDateString() });
Â  Â  Â  Â  Â  Â  document.getElementById("chatIn").value = "";
Â  Â  Â  Â  }

Â  Â  Â  Â  function yedekIndir() {
Â  Â  Â  Â  Â  Â  let a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([JSON.stringify(localStorage)], {type: "application/json"})); a.download = "yedek.json"; a.click();
Â  Â  Â  Â  }
Â  Â  Â  Â  function yedekYukle(input) {
Â  Â  Â  Â  Â  Â  let r = new FileReader(); r.onload = e => { let d=JSON.parse(e.target.result); for(let k in d) localStorage.setItem(k,d[k]); location.reload(); }; r.readAsText(input.files[0]);
Â  Â  Â  Â  }
Â  Â  </script>
</body>

</html>
